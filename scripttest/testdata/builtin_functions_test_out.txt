set max_line_width 200;
OK

topic_if := (kafka in partitions = 10)
-> (project key,  if(json_int("v0",val) > 1005, "antelopes", "zebras") as animal)
-> (store stream);
OK

topic_case := (kafka in partitions = 10)
-> (project key,  case(json_int("v0",val), 
         1, "happy",
         2, "sad",
         "meh") as mood)
-> (store stream);
OK

topic_isNull := (kafka in partitions = 10)
-> (filter by is_null(json_int("v0",val)))
-> (store stream);
OK

topic_isNotNull := (kafka in partitions = 10)
-> (filter by is_not_null(json_int("v0",val)))
-> (store stream);
OK

topic_in := (kafka in partitions = 10)
-> (filter by in(json_int("v0", val), 1, 2, 3))
-> (store stream);
OK

topic_decimalShift := (kafka in partitions = 10)
-> (project key, decimal_shift(to_decimal(json_float("v1", val), 4, 2), 2) as new_v1)
-> (store stream);
OK

topic_startsWith := (kafka in partitions = 10)
-> (filter by starts_with(json_string("v4", val), "foo"))
-> (store stream);
OK

topic_endsWith := (kafka in partitions = 10)
-> (filter by ends_with(json_string("v4", val), "o01"))
-> (store stream);
OK

matchesTopic := (kafka in partitions = 10)
-> (filter by matches(json_string("v4", val), "^bar"))
-> (store stream);
OK

trimTopic := (kafka in partitions = 10)
-> (filter by trim(json_string("v4", val), " \t\n\r") == "bar")
-> (store stream);
OK

ltrimTopic := (kafka in partitions = 10)
-> (filter by ltrim(json_string("v4", val), " \t\n\r") == "bar")
-> (store stream);
OK

rtrimTopic := (kafka in partitions = 10)
-> (filter by rtrim(json_string("v4", val), " \t\n\r") == "bar")
-> (store stream);
OK

toLowerTopic := (kafka in partitions = 10)
-> (filter by to_lower(json_string("v4", val)) == "bar")
-> (store stream);
OK

toUpperTopic := (kafka in partitions = 10)
-> (filter by to_lower(json_string("v4", val)) == "bar")
-> (store stream);
OK

substrTopic := (kafka in partitions = 10)
-> (filter by sub_str(json_string("v4", val), 0, 3) == "foo")
-> (store stream);
OK

replaceTopic := (kafka in partitions = 10)
-> (project key,  replace(json_string("v4",val), "foobar", "BARFOO") as replaced)
-> (store stream);
OK

sprintfTopic := (kafka in partitions = 10)
-> (project key, sprintf("v0:%s v1:%.2f",
                 json_string("v0",val), json_float("v1",val)) as summary)
-> (store stream);
OK

toIntTopic := (kafka in partitions = 10)
-> (project key, to_int(json_string("v3",val)) as summary)
-> (store stream);
OK

toFloatTopic := (kafka in partitions = 10)
-> (project key, to_float(json_string("v3",val)) as summary)
-> (store stream);
OK

toStringTopic := (kafka in partitions = 10)
-> (project key, to_string(json_float("v3",val)) as summary)
-> (store stream);
OK

toDecimalTopic := (kafka in partitions = 10)
-> (project key, to_decimal(json_float("v1",val),4,2) as summary)
-> (store stream);
OK

toBytesTopic := (kafka in partitions = 10)
-> (project key, to_bytes(json_string("v0",val)) as summary)
-> (store stream);
OK

toTimestampTopic := (kafka in partitions = 10)
-> (project key, to_timestamp(json_int("v0",val)) as summary)
-> (store stream);
OK

formatDateTopic := (kafka in partitions = 10)
-> (project key, format_date(to_timestamp(json_int("v0",val)),"2006-01-02T15:04:05Z07:00") as summary)
-> (store stream);
OK

parseDateTopic := (kafka in partitions = 10)
-> (project key, parse_date(json_string("v6",val),"2006-01-02 15:04:05.000") as summary)
-> (store stream);
OK

dateTopic := (kafka in partitions = 10)
-> (filter by 
year(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) == 2008
&& 
month(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) == 8
&&
day(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) == 8
&&
hour(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) == 8
&&
minute(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) == 8
&&
second(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) == 8
&&
millis(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) == 128
)
-> (store stream);
OK

nowTopic := (kafka in partitions = 10)
-> (filter by year(to_timestamp(parse_date(json_string("v6",val),"2006-01-02 15:04:05.000"))) < year(now()))
-> (store stream);
OK

jsonFnTopic := (kafka in partitions = 10)
-> (filter by json_int("v0",val) == 1000 
&& 
json_float("v1",val) == 1.23f 
&&
json_bool("v2",val) == true
&&
json_is_null("v3",val)
&&
json_string("v4",val) == "foobar01"
&&
json_raw("v0",val) == "1000"
&&
json_type("v4",val) == "string"
)
-> (store stream);
OK

kafkaHelperTopic := (kafka in partitions = 10)
-> (project key, kafka_header("sender_id", hdrs) as sender_id, kafka_build_headers("event_processing_time", to_string(event_time)))
-> (store stream);
OK

miscTopic := (kafka in partitions = 10)
-> (project key, if(len(concat(json_string("v0",val),json_string("v1",val))) > 8, "big", "small") as size,
bytes_slice(to_bytes(json_string("v0",val)),2,4) as slice,
uint64_be(to_bytes(json_string("v0",val)),-1) as be,
uint64_le(to_bytes(json_string("v0",val)),-1) as le
)
-> (store stream);
OK

--produce data dataset_if;
--produce data dataset_case;
--produce data dataset_isNull;
--produce data dataset_isNotNull;
--produce data dataset_in;
--produce data dataset_decimalShift;
--produce data dataset_startsWith;
--produce data dataset_endsWith;
--produce data dataset_matches;
--produce data dataset_trim;
--produce data dataset_ltrim;
--produce data dataset_rtrim;
--produce data dataset_toLower;
--produce data dataset_toUpper;
--produce data dataset_substr;
--produce data dataset_replace;
--produce data dataset_sprintf;
--produce data dataset_toInt;
--produce data dataset_toFloat;
--produce data dataset_toString;
--produce data dataset_toDecimal;
--produce data dataset_toBytes;
--produce data dataset_toTimestamp;
--produce data dataset_formatDate;
--produce data dataset_parseDate;
--produce data dataset_date;
--produce data dataset_now;
--produce data dataset_jsonFn;
--produce data dataset_kafkaHelper;
--produce data dataset_misc;

(scan all from topic_if) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | animal                                                                 |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | zebras                                                                 |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | zebras                                                                 |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | antelopes                                                              |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | antelopes                                                              |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | antelopes                                                              |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | antelopes                                                              |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from topic_case) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | mood                                                                   |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | happy                                                                  |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | happy                                                                  |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | happy                                                                  |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | sad                                                                    |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | sad                                                                    |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | sad                                                                    |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | meh                                                                    |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | meh                                                                    |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | meh                                                                    |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | meh                                                                    |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from topic_isNull) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": null,"v1": 1.23,"v2": true,"v3": "123.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": null,"v1": 3.23,"v2": true,"v3": "323.. |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                          | .                                              | {"v0": null,"v1": 5.23,"v2": true,"v3": "523.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": null,"v1": 7.23,"v2": true,"v3": "723.. |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | .                                              | {"v0": null,"v1": 9.23,"v2": true,"v3": "923.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows returned
(scan all from topic_isNotNull) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1,"v1": 1.23,"v2": true,"v3": "123456.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": 1,"v1": 3.23,"v2": true,"v3": "323456.. |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                          | .                                              | {"v0": 2,"v1": 5.23,"v2": true,"v3": "523456.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | .                                              | {"v0": 3,"v1": 9.23,"v2": true,"v3": "923456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows returned
(scan all from topic_in) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1,"v1": 1.23,"v2": true,"v3": "123456.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": 1,"v1": 3.23,"v2": true,"v3": "323456.. |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                          | .                                              | {"v0": 2,"v1": 5.23,"v2": true,"v3": "523456.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | .                                              | {"v0": 3,"v1": 9.23,"v2": true,"v3": "923456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows returned
(scan all from topic_decimalShift) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | new_v1                                                                 |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | 123.00                                                                 |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | 223.00                                                                 |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | 323.00                                                                 |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | 423.00                                                                 |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | 523.00                                                                 |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | 623.00                                                                 |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | 723.00                                                                 |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | 823.00                                                                 |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | 923.00                                                                 |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | 1023.00                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from topic_startsWith) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": null,"v1": 1.23,"v2": true,"v3": "123.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": null,"v1": 3.23,"v2": true,"v3": "323.. |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                          | .                                              | {"v0": null,"v1": 5.23,"v2": true,"v3": "523.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": null,"v1": 7.23,"v2": true,"v3": "723.. |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | .                                              | {"v0": null,"v1": 9.23,"v2": true,"v3": "923.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows returned
(scan all from topic_endsWith) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": null,"v1": 1.23,"v2": true,"v3": "123.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row returned
(scan all from matchesTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1,"v1": 1.23,"v2": true,"v3": "123456.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": 1,"v1": 3.23,"v2": true,"v3": "323456.. |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                          | .                                              | {"v0": 2,"v1": 5.23,"v2": true,"v3": "523456.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | .                                              | {"v0": 3,"v1": 9.23,"v2": true,"v3": "923456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows returned
(scan all from trimTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1,"v1": 1.23,"v2": true,"v3": "123456.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": 1,"v1": 3.23,"v2": true,"v3": "323456.. |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                          | .                                              | {"v0": 2,"v1": 5.23,"v2": true,"v3": "523456.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | .                                              | {"v0": 3,"v1": 9.23,"v2": true,"v3": "923456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows returned
(scan all from ltrimTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | .                                              | {"v0": 3,"v1": 9.23,"v2": true,"v3": "923456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
2 rows returned
(scan all from rtrimTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1,"v1": 1.23,"v2": true,"v3": "123456.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": 1,"v1": 3.23,"v2": true,"v3": "323456.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
3 rows returned
(scan all from toLowerTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row returned
(scan all from toUpperTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1,"v1": 1.23,"v2": true,"v3": "123456.. |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | .                                              | {"v0": 1,"v1": 3.23,"v2": true,"v3": "323456.. |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | .                                              | {"v0": 3,"v1": 7.23,"v2": true,"v3": "723456.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
3 rows returned
(scan all from substrTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:05:05.000000 | key02                                          | .                                              | {"v0": null,"v1": 2.23,"v2": false,"v3": "22.. |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                          | .                                              | {"v0": null,"v1": 4.23,"v2": false,"v3": "42.. |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                          | .                                              | {"v0": null,"v1": 6.23,"v2": false,"v3": "62.. |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                          | .                                              | {"v0": null,"v1": 8.23,"v2": false,"v3": "82.. |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                          | .                                              | {"v0": null,"v1": 10.23,"v2": false,"v3": "1.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows returned
(scan all from replaceTopic) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | replaced                                                               |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | BARFOO01                                                               |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | BARFOO02                                                               |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | BARFOO03                                                               |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | BARFOO04                                                               |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | BARFOO05                                                               |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | BARFOO06                                                               |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | BARFOO07                                                               |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | BARFOO08                                                               |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | BARFOO09                                                               |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | BARFOO10                                                               |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from sprintfTopic) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | summary                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | v0:1000 v1:1.23                                                        |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | v0:1001 v1:2.23                                                        |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | v0:1002 v1:3.23                                                        |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | v0:1003 v1:4.23                                                        |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | v0:1004 v1:5.23                                                        |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | v0:1005 v1:6.23                                                        |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | v0:1006 v1:7.23                                                        |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | v0:1007 v1:8.23                                                        |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | v0:1008 v1:9.23                                                        |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | v0:1009 v1:10.23                                                       |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from toIntTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                                                                       | summary              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                                                                     | 12345678             |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                                                                     | 22345678             |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                                                                     | 32345678             |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                                                                     | 42345678             |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                                                                     | 52345678             |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                                                                     | 62345678             |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                                                                     | 72345678             |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                                                                     | 82345678             |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                                                                     | 92345678             |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                                                                     | 102345678            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from toFloatTopic) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | summary                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | 12345678.765432                                                        |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | 22345678.765432                                                        |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | 32345678.765432                                                        |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | 42345678.765432                                                        |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | 52345678.765432                                                        |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | 62345678.765432                                                        |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | 72345678.765432                                                        |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | 82345678.765432                                                        |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | 92345678.765432                                                        |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | 102345678.765432                                                       |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from toStringTopic) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | summary                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | 12345678.7654321                                                       |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | 22345678.7654321                                                       |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | 32345678.7654321                                                       |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | 42345678.7654321                                                       |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | 52345678.7654321                                                       |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | 62345678.7654321                                                       |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | 72345678.7654321                                                       |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | 82345678.7654321                                                       |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | 92345678.7654321                                                       |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | 102345678.7654321                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from toDecimalTopic) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | summary                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | 1.23                                                                   |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | 2.23                                                                   |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | 3.23                                                                   |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | 4.23                                                                   |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | 5.23                                                                   |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | 6.23                                                                   |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | 7.23                                                                   |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | 8.23                                                                   |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | 9.23                                                                   |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | 10.23                                                                  |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from toBytesTopic) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | summary                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | 1000                                                                   |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | 1001                                                                   |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | 1002                                                                   |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | 1003                                                                   |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | 1004                                                                   |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | 1005                                                                   |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | 1006                                                                   |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | 1007                                                                   |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | 1008                                                                   |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | 1009                                                                   |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from toTimestampTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                                                                 | summary                    |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                                                               | 1970-01-01 00:00:01.000000 |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                                                               | 1970-01-01 00:00:01.001000 |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                                                               | 1970-01-01 00:00:01.002000 |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                                                               | 1970-01-01 00:00:01.003000 |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                                                               | 1970-01-01 00:00:01.004000 |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                                                               | 1970-01-01 00:00:01.005000 |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                                                               | 1970-01-01 00:00:01.006000 |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                                                               | 1970-01-01 00:00:01.007000 |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                                                               | 1970-01-01 00:00:01.008000 |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                                                               | 1970-01-01 00:00:01.009000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from formatDateTopic) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | summary                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | 1970-01-01T00:00:01Z                                                   |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | 1970-01-01T00:00:01Z                                                   |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | 1970-01-01T00:00:01Z                                                   |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | 1970-01-01T00:00:01Z                                                   |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | 1970-01-01T00:00:01Z                                                   |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | 1970-01-01T00:00:01Z                                                   |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | 1970-01-01T00:00:01Z                                                   |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | 1970-01-01T00:00:01Z                                                   |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | 1970-01-01T00:00:01Z                                                   |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | 1970-01-01T00:00:01Z                                                   |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from parseDateTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                                                                 | summary                    |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                                                               | 2008-04-03 23:21:17.123000 |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                                                               | 2008-04-03 23:22:17.123000 |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                                                               | 2008-04-03 23:23:17.123000 |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                                                               | 2008-04-03 23:24:17.123000 |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                                                               | 2008-04-03 23:25:17.123000 |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                                                               | 2008-04-03 23:26:17.123000 |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                                                               | 2008-04-03 23:27:17.123000 |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                                                               | 2008-04-03 23:28:17.123000 |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                                                               | 2008-04-03 23:29:17.123000 |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                                                               | 2008-04-03 23:30:17.123000 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from dateTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1                    | 2006-01-02 15:11:05.000000 | key08                                          | .                                              | {"v0": 1007,"v1": 8.23,"v2": false,"v3": "82.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row returned
(scan all from nowTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1000,"v1": 1.23,"v2": true,"v3": "123.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row returned
(scan all from jsonFnTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | hdrs                                           | val                                            |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | .                                              | {"v0": 1000,"v1": 1.23,"v2": true,"v3": null.. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row returned
(scan all from kafkaHelperTopic) -> (sort by key);
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                            | sender_id                                      | col2                                           |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                          | null                                           | .*event_processing_time.1136214245000          |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                          | null                                           | .*event_processing_time.1136214305000          |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                          | null                                           | .*event_processing_time.1136214365000          |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                          | null                                           | .*event_processing_time.1136214425000          |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                          | null                                           | .*event_processing_time.1136214485000          |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                          | null                                           | .*event_processing_time.1136214545000          |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                          | null                                           | .*event_processing_time.1136214605000          |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                          | null                                           | .*event_processing_time.1136214665000          |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                          | null                                           | .*event_processing_time.1136214725000          |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                          | null                                           | .*event_processing_time.1136214785000          |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from miscTopic) -> (sort by key);
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                            | size                           | slice                          | be                   | le                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                          | small                          | 00                             | null                 | null                 |
| 0                    | 2006-01-02 15:05:05.000000 | key02                          | small                          | 01                             | null                 | null                 |
| 0                    | 2006-01-02 15:06:05.000000 | key03                          | small                          | 02                             | null                 | null                 |
| 0                    | 2006-01-02 15:07:05.000000 | key04                          | small                          | 03                             | null                 | null                 |
| 0                    | 2006-01-02 15:08:05.000000 | key05                          | small                          | 04                             | null                 | null                 |
| 1                    | 2006-01-02 15:09:05.000000 | key06                          | small                          | 05                             | null                 | null                 |
| 1                    | 2006-01-02 15:10:05.000000 | key07                          | small                          | 06                             | null                 | null                 |
| 1                    | 2006-01-02 15:11:05.000000 | key08                          | small                          | 07                             | null                 | null                 |
| 0                    | 2006-01-02 15:12:05.000000 | key09                          | small                          | 08                             | null                 | null                 |
| 2                    | 2006-01-02 15:13:05.000000 | key10                          | big                            | 09                             | null                 | null                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned

delete(topic_if);
OK
delete(topic_case);
OK
delete(topic_isNull);
OK
delete(topic_isNotNull);
OK
delete(topic_in);
OK
delete(topic_decimalShift);
OK
delete(topic_startsWith);
OK
delete(topic_endsWith);
OK
delete(matchesTopic);
OK
delete(trimTopic);
OK
delete(ltrimTopic);
OK
delete(rtrimTopic);
OK
delete(toLowerTopic);
OK
delete(toUpperTopic);
OK
delete(substrTopic);
OK
delete(replaceTopic);
OK
delete(sprintfTopic);
OK
delete(toIntTopic);
OK
delete(toFloatTopic);
OK
delete(toStringTopic);
OK
delete(toDecimalTopic);
OK
delete(toBytesTopic);
OK
delete(toTimestampTopic);
OK
delete(formatDateTopic);
OK
delete(parseDateTopic);
OK
delete(dateTopic);
OK
delete(nowTopic);
OK
delete(jsonFnTopic);
OK
delete(kafkaHelperTopic);
OK
delete(miscTopic);
OK
