set max_line_width 200;
OK

topic1 := (kafka in partitions = 10)
-> (project key,  case(json_int("v0",val), 
         1, "happy",
         2, "sad",
         "meh") as mood)
-> (store stream);
OK

--produce data dataset_1;

(scan all from topic1) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | mood                                                                   |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | happy                                                                  |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | happy                                                                  |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | happy                                                                  |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | sad                                                                    |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | sad                                                                    |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | sad                                                                    |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | meh                                                                    |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | meh                                                                    |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | meh                                                                    |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | meh                                                                    |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned

delete(topic1);
OK
