set max_line_width 200;
OK

topic1 := (kafka in partitions = 10)
-> (project key, decimal_shift(to_decimal(json_float("v1", val), 4, 2), 2) as new_v1)
-> (store stream);
OK

--produce data dataset_1;

(scan all from topic1) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | new_v1                                                                 |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | 123.00                                                                 |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | 223.00                                                                 |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | 323.00                                                                 |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | 423.00                                                                 |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | 523.00                                                                 |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | 623.00                                                                 |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | 723.00                                                                 |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | 823.00                                                                 |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | 923.00                                                                 |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | 1023.00                                                                |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned

delete(topic1);
OK
