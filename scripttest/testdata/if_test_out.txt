set max_line_width 200;
OK

topic1 := (kafka in partitions = 10)
-> (project key,  if(json_int("v0",val) > 1005, "antelopes", "zebras") as animal)
-> (store stream);
OK

--produce data dataset_1;

(scan all from topic1) -> (sort by key);
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key                                                                    | animal                                                                 |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:05:05.000000 | key02                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:06:05.000000 | key03                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:07:05.000000 | key04                                                                  | zebras                                                                 |
| 0                    | 2006-01-02 15:08:05.000000 | key05                                                                  | zebras                                                                 |
| 1                    | 2006-01-02 15:09:05.000000 | key06                                                                  | zebras                                                                 |
| 1                    | 2006-01-02 15:10:05.000000 | key07                                                                  | antelopes                                                              |
| 1                    | 2006-01-02 15:11:05.000000 | key08                                                                  | antelopes                                                              |
| 0                    | 2006-01-02 15:12:05.000000 | key09                                                                  | antelopes                                                              |
| 2                    | 2006-01-02 15:13:05.000000 | key10                                                                  | antelopes                                                              |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned

delete(topic1);
OK
